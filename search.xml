<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Linuxå®‰è£…docker</title>
      <link href="/2023/08/27/jiao-cheng/linux-an-zhuang-docker/"/>
      <url>/2023/08/27/jiao-cheng/linux-an-zhuang-docker/</url>
      
        <content type="html"><![CDATA[<p>è®°å½•ä¸‹dockeræœåŠ¡çš„å®‰è£…ï¼Œç›®å‰åªæ¶‰åŠåˆ°äº†centosç³»ç»Ÿï¼Œæ­¤è´´ä¼šè®°å½•åšä¸»åœ¨ä¸åŒç³»ç»Ÿä¸­çš„dockerå®‰è£…æ•™ç¨‹ã€‚(å…¶ä»–çš„ä»€ä¹ˆæ—¶å€™æ›´æ–°å°±çœ‹åšä¸»å•¥æ—¶å€™é‡åˆ°äº†)</p><h3 id="CentOS-docker-å®‰è£…"><a href="#CentOS-docker-å®‰è£…" class="headerlink" title="CentOS docker å®‰è£…"></a>CentOS docker å®‰è£…</h3><h4 id="æ¸…é™¤å·²å®‰è£…çš„éƒ¨åˆ†-è‹¥æ˜¯æ–°æœºå™¨å¯è·³è¿‡"><a href="#æ¸…é™¤å·²å®‰è£…çš„éƒ¨åˆ†-è‹¥æ˜¯æ–°æœºå™¨å¯è·³è¿‡" class="headerlink" title="æ¸…é™¤å·²å®‰è£…çš„éƒ¨åˆ†(è‹¥æ˜¯æ–°æœºå™¨å¯è·³è¿‡)"></a>æ¸…é™¤å·²å®‰è£…çš„éƒ¨åˆ†(è‹¥æ˜¯æ–°æœºå™¨å¯è·³è¿‡)</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">yum remove <span class="token function">docker</span> <span class="token punctuation">\</span>docker-client <span class="token punctuation">\</span>docker-client-latest <span class="token punctuation">\</span>docker-common <span class="token punctuation">\</span>docker-latest <span class="token punctuation">\</span>docker-latest-logrotate <span class="token punctuation">\</span>docker-logrotate <span class="token punctuation">\</span>docker-engine<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="å‰ç½®å¤„ç†"><a href="#å‰ç½®å¤„ç†" class="headerlink" title="å‰ç½®å¤„ç†"></a>å‰ç½®å¤„ç†</h4><p>yum-complete-transaction    æ¸…ç†æœªå®Œæˆäº‹åŠ¡<br>yum install -y yum-utils    å®‰è£…ä¾èµ–å·¥å…·<br>yum clean all               æ¸…æ¥šæœªå®Œæˆçš„åŒ…å’Œç¼“å­˜<br>yum  update                 æ›´æ–°</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">yum-complete-transaction <span class="token operator">&amp;&amp;</span> yum <span class="token function">install</span> <span class="token parameter variable">-y</span> yum-utils <span class="token operator">&amp;&amp;</span> yum clean all <span class="token operator">&amp;&amp;</span> yum-complete-transaction <span class="token operator">&amp;&amp;</span> yum update<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="å®‰è£…åº•å±‚ä¾èµ–"><a href="#å®‰è£…åº•å±‚ä¾èµ–" class="headerlink" title="å®‰è£…åº•å±‚ä¾èµ–"></a>å®‰è£…åº•å±‚ä¾èµ–</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">yum <span class="token function">install</span> <span class="token parameter variable">-y</span> device-mapper-persistent-data lvm2<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="æ›´æ–°yumç¼“å­˜"><a href="#æ›´æ–°yumç¼“å­˜" class="headerlink" title="æ›´æ–°yumç¼“å­˜"></a>æ›´æ–°yumç¼“å­˜</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">yum makecache fast<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="å®‰è£…docker"><a href="#å®‰è£…docker" class="headerlink" title="å®‰è£…docker"></a>å®‰è£…docker</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">yum <span class="token function">install</span> docker-ce docker-ce-cli containerd.io<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="å¯åŠ¨docker"><a href="#å¯åŠ¨docker" class="headerlink" title="å¯åŠ¨docker"></a>å¯åŠ¨docker</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">systemctl start <span class="token function">docker</span> <span class="token operator">&amp;&amp;</span> systemctl status <span class="token function">docker</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="æµ‹è¯•è¿è¡Œdocker"><a href="#æµ‹è¯•è¿è¡Œdocker" class="headerlink" title="æµ‹è¯•è¿è¡Œdocker"></a>æµ‹è¯•è¿è¡Œdocker</h4><p>æ­¤æ­¥ä¼šè¾“å‡ºhello-worldï¼Œè¾“å‡ºæˆåŠŸå³dockerå®‰è£…æˆåŠŸï¼Œå°±å¯ä»¥æ„‰å¿«çš„ç©è€å•¦ã€‚ğŸ‰ğŸ‰</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">docker</span> run hello-world<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> æ•™ç¨‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> docker </tag>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Pythonç”Ÿæ´»-å®šæ—¶å‘é€æ–°é—»è”æ’­åˆ°å¾®ä¿¡</title>
      <link href="/2023/07/09/yi-xie-jiao-ben/python-sheng-huo-ding-shi-fa-song-xin-wen-lian-bo-dao-wei-xin/"/>
      <url>/2023/07/09/yi-xie-jiao-ben/python-sheng-huo-ding-shi-fa-song-xin-wen-lian-bo-dao-wei-xin/</url>
      
        <content type="html"><![CDATA[<p>åˆ†äº«ä¸€ä¸ªè„šæœ¬ï¼Œé€šè¿‡Pythonå¼€å‘çš„ä¸€ä¸ªæ–°é—»è”æ’­æ¨é€è„šæœ¬ã€‚è¯¥é¡¹ç›®åº”ç”¨åœºæ™¯å¹¿æ³›ç‚’è‚¡çš„å¤§ä½¬ä»¬ï¼Œæ–°é—»å·¥ä½œè€…ï¼Œè¦è€ƒå…¬çš„æœªæ¥æ¥ç­äººä»¥åŠéœ€è¦äº†è§£å›½å®¶å¤§äº‹çš„ï¼Œéƒ½å¯ä»¥é€šè¿‡è¿™ä¸ªå¿«é€Ÿçš„è·å–åˆ°æ–°é—»è”æ’­ä¿¡æ¯ã€‚</p><p>å…å»äº†å®šæ—¶è¦å»è§‚çœ‹30åˆ†é’Ÿçš„æ–°é—»è§†é¢‘ã€‚ç›´æ¥æ–‡å­—è¾“å‡ºæ–°é—»è”æ’­ï¼Œä¸€å­—ä¸å·®ã€‚ç›´æ¥æ¨é€åˆ°å¾®ä¿¡é‚®ç®±(å¾®ä¿¡ä¸­çš„QQé‚®ç®±æé†’ä¸­ç»‘å®šçš„é‚®ç®±)</p><h3 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h3><p>é¡¹ç›®ä¸­åˆ†ä¸ºä¸¤éƒ¨åˆ†ç¬¬ä¸€éƒ¨åˆ†é€šè¿‡æ–°é—»è”æ’­åœ°å€è·å–æ–°é—»è”æ’­çš„æ–‡å­—å†…å®¹ï¼Œç¬¬äºŒéƒ¨åˆ†å°†æ–‡å­—å†…å®¹å‘é€åˆ°é‚®ç®±</p><p>æˆ‘ä»¬æ¥çœ‹ä¸‹å…³é”®éƒ¨åˆ†è·å–æ–°é—»è”æ’­çš„æ–‡å­—å†…å®¹</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> re<span class="token keyword">import</span> requests<span class="token keyword">from</span> lxml <span class="token keyword">import</span> etree<span class="token keyword">import</span> datetime<span class="token keyword">import</span> yagmailheaders <span class="token operator">=</span> <span class="token punctuation">&#123;</span>    <span class="token string">'User-Agent'</span><span class="token punctuation">:</span> <span class="token string">'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/96.0.4651.0 Safari/537.36'</span><span class="token punctuation">&#125;</span><span class="token comment"># è·å–æ–°é—»</span><span class="token keyword">def</span> <span class="token function">get_hanlder</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">try</span><span class="token punctuation">:</span>        rsp <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span>        rsp<span class="token punctuation">.</span>raise_for_status<span class="token punctuation">(</span><span class="token punctuation">)</span>        rsp<span class="token punctuation">.</span>encoding <span class="token operator">=</span> rsp<span class="token punctuation">.</span>apparent_encoding        <span class="token comment"># print(rsp.text)</span>        <span class="token keyword">return</span> rsp<span class="token punctuation">.</span>text    <span class="token keyword">except</span> requests<span class="token punctuation">.</span>RequestException <span class="token keyword">as</span> error<span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span>        exit<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">get_news</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">:</span>    rsp <span class="token operator">=</span> get_hanlder<span class="token punctuation">(</span>url<span class="token punctuation">)</span>    etr <span class="token operator">=</span> etree<span class="token punctuation">.</span>HTML<span class="token punctuation">(</span>rsp<span class="token punctuation">)</span>    titles <span class="token operator">=</span> etr<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">"//li/a/text()"</span><span class="token punctuation">)</span>    hrefs <span class="token operator">=</span> etr<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">"//li/a/@href"</span><span class="token punctuation">)</span>    news <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    summary <span class="token operator">=</span> <span class="token boolean">None</span>    <span class="token keyword">for</span> title<span class="token punctuation">,</span> href <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>titles<span class="token punctuation">,</span> hrefs<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> <span class="token string">'ã€Šæ–°é—»è”æ’­ã€‹'</span> <span class="token keyword">in</span> title<span class="token punctuation">:</span>            <span class="token comment"># è·å–æ–°é—»æ¦‚è¦</span>            title_rsp <span class="token operator">=</span> get_hanlder<span class="token punctuation">(</span>href<span class="token punctuation">)</span>            summary <span class="token operator">=</span> re<span class="token punctuation">.</span>search<span class="token punctuation">(</span><span class="token string">r'&lt;div class="video_brief">æœ¬æœŸèŠ‚ç›®ä¸»è¦å†…å®¹ï¼š[\s\S]*ã€‚'</span><span class="token punctuation">,</span> title_rsp<span class="token punctuation">)</span><span class="token punctuation">.</span>group<span class="token punctuation">(</span>                <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"&lt;/div>\n\n\n"</span>            <span class="token keyword">continue</span>        <span class="token comment"># æ–°é—»æ ‡é¢˜å»æ‰è§†é¢‘å¹¶å¤„ç†æˆè¶…é“¾æ¥  æ©™è‰² #D2691E</span>        tit <span class="token operator">=</span> re<span class="token punctuation">.</span>sub<span class="token punctuation">(</span><span class="token string">r"\[è§†é¢‘\]?"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> title<span class="token punctuation">)</span>        subtitle <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f'&lt;a href=\"</span><span class="token interpolation"><span class="token punctuation">&#123;</span>href<span class="token punctuation">&#125;</span></span><span class="token string">\" style="color:#4682B4">&lt;b></span><span class="token interpolation"><span class="token punctuation">&#123;</span>tit<span class="token punctuation">&#125;</span></span><span class="token string">&lt;/b>&lt;/a>'</span></span>        summary <span class="token operator">=</span> re<span class="token punctuation">.</span>sub<span class="token punctuation">(</span>tit<span class="token punctuation">,</span> subtitle<span class="token punctuation">,</span> summary<span class="token punctuation">)</span>        <span class="token comment"># è·å–æ–°é—»æ­£æ–‡å¹¶æ·»åŠ åˆ°news</span>        news_text <span class="token operator">=</span> get_hanlder<span class="token punctuation">(</span>href<span class="token punctuation">)</span>        news_th <span class="token operator">=</span> re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token string">r'&lt;div class="content_area" id="content_area">.*&lt;/div>'</span><span class="token punctuation">,</span> news_text<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>        news<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">&#123;</span>subtitle<span class="token punctuation">&#125;</span></span><span class="token string">\n</span><span class="token interpolation"><span class="token punctuation">&#123;</span>news_th<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>    news<span class="token punctuation">.</span>insert<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> summary<span class="token punctuation">)</span>    <span class="token keyword">return</span> news<span class="token keyword">def</span> <span class="token function">email_send</span><span class="token punctuation">(</span>rsp<span class="token punctuation">,</span> strdate<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment"># å‘é€æ•°æ®åˆ°é‚®ç®± æ­¤å¤„å‘é€ç«¯ä¸ºQQé‚®ç®±</span>    yag <span class="token operator">=</span> yagmail<span class="token punctuation">.</span>SMTP<span class="token punctuation">(</span>user<span class="token operator">=</span><span class="token string">'yourQQ@qq.com'</span><span class="token punctuation">,</span> password<span class="token operator">=</span><span class="token string">'your send code'</span><span class="token punctuation">,</span> host<span class="token operator">=</span><span class="token string">'smtp.qq.com'</span><span class="token punctuation">,</span> port<span class="token operator">=</span><span class="token number">465</span><span class="token punctuation">)</span>    yag<span class="token punctuation">.</span>send<span class="token punctuation">(</span>to<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"acceptQQ1@qq.com"</span><span class="token punctuation">,</span> <span class="token string">"acceptQQ2@qq.com"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> subject<span class="token operator">=</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">&#123;</span>strdate<span class="token punctuation">&#125;</span></span><span class="token string">æ—¥æ–°é—»è”æ’­æ¨é€"</span></span><span class="token punctuation">,</span> contents<span class="token operator">=</span>rsp<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'é‚®ä»¶å·²å‘é€è¯·æŸ¥æ”¶...'</span><span class="token punctuation">)</span><span class="token comment"># event,contextè¿™ä¸¤ä¸ªå‚æ•°ä¸åŒçš„å‚å•†æ˜¯ä¸åŒçš„åç§°ï¼Œè¯·æ ¹æ®å‚å•†çš„ç¤ºä¾‹è¿›è¡Œä¿®æ”¹å³å¯</span><span class="token keyword">def</span> <span class="token function">scf_run</span><span class="token punctuation">(</span>event<span class="token punctuation">,</span> context<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment"># è·å–æ—¥æœŸè¿™é‡Œé»˜è®¤ä¸ºç¬¬äºŒå¤©è·å–å‰ä¸€å¤©çš„æ‰€ä»¥-1,è‹¥æ˜¯å½“å¤©è·å–åˆ™æ— éœ€-1æ”¹ä¸º0å³å¯</span>    strTime <span class="token operator">=</span> <span class="token punctuation">(</span>datetime<span class="token punctuation">.</span>date<span class="token punctuation">.</span>today<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> datetime<span class="token punctuation">.</span>timedelta<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">"%Y%m%d"</span><span class="token punctuation">)</span>    url <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f'https://tv.cctv.com/lm/xwlb/day/</span><span class="token interpolation"><span class="token punctuation">&#123;</span>strTime<span class="token punctuation">&#125;</span></span><span class="token string">.shtml'</span></span>    news_text <span class="token operator">=</span> get_news<span class="token punctuation">(</span>url<span class="token punctuation">)</span>    email_send<span class="token punctuation">(</span>news_text<span class="token punctuation">,</span> strTime<span class="token punctuation">)</span><span class="token comment"># è‹¥éƒ¨ç½²åœ¨äº‘å‡½æ•°ä¸Šè¯·æŠŠä¸‹é¢è¿™è¡Œæ³¨é‡Šæ‰,éäº‘å‡½æ•°ä¸Šä¸ç”¨æ³¨é‡Š</span>scf_run<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä»£ç é‡Šä¹‰ï¼š<br>é¦–å…ˆå°†æ–°é—»è”æ’­é¡µé¢é€šè¿‡Xpathè·å–æˆ‘ä»¬éœ€è¦è·å–çš„æ–°é—»è”æ’­çš„æ ‡é¢˜ä»¥åŠé“¾æ¥ã€‚å†å°†é“¾æ¥å’Œæ ‡é¢˜è¿›è¡Œç»‘å®šå¾ªç¯å–å‡ºå¹¶è·å–å†…å®¹ã€‚<br>å°†è·å–çš„å†…å®¹ä½œä¸ºé‚®ä»¶çš„å†…å®¹è¿›è¡Œå‘é€</p><p>tips:</p><p>1ã€é»˜è®¤è°ƒç”¨æ—¶æ˜¯è·å–å‰ä¸€å¤©çš„å†…å®¹ï¼Œè‹¥éœ€è¦è·å–å½“å¤©çš„è¯·æŠŠé‡Œé¢(datetime.date.today() + datetime.timedelta(-1)).strftime(â€œ%Y%m%dâ€) è¿™æ®µä»£ç ä¸­çš„â€œ-1â€ä¿®æ”¹ä¸ºâ€œ0â€ï¼Œè‹¥å½“å¤©æ‰§è¡Œæ—¶ä¸º20:00å‰å¯èƒ½ä¼šè·å–ä¸åˆ°å› ä¸ºå½“å¤©çš„æ–°é—»è¿˜æ²¡å‡ºæ¥</p><p>2ã€è¯·æ³¨æ„ä¿®æ”¹å‘é€è€…çš„é‚®ç®±å’Œå¼€å¯SMTPæœåŠ¡åçš„ç§˜é’¥</p><h3 id="é‚®ä»¶å±•ç¤º"><a href="#é‚®ä»¶å±•ç¤º" class="headerlink" title="é‚®ä»¶å±•ç¤º"></a>é‚®ä»¶å±•ç¤º</h3><p><img src="https://im.gurl.eu.org/file/327217c814cecb814371b.png" alt="é‚®ä»¶å±•ç¤º"></p><h3 id="å®šæ—¶å‘é€"><a href="#å®šæ—¶å‘é€" class="headerlink" title="å®šæ—¶å‘é€"></a>å®šæ—¶å‘é€</h3><p>å®šæ—¶å‘é€è¿™é‡Œæœ‰ä¸¤ä¸ªé€‰æ‹©ï¼Œç¬¬ä¸€ç§å°±æ˜¯è‡ªå·±æœ‰æœåŠ¡å™¨ï¼Œé€šè¿‡crontab è¿›è¡Œå®šæ—¶è°ƒç”¨ã€‚ç¬¬äºŒç§å°±æ˜¯é€šè¿‡å„å¤§äº‘å‚å•†çš„äº‘å‡½æ•°è¿›è¡Œéƒ¨ç½²ï¼Œè®¾å®šå‡½æ•°è§¦å‘æ—¶é—´å³å¯ã€‚é‡è¦çš„æ˜¯ä¸éœ€è¦ææœåŠ¡å™¨é’±ï¼Œäº‘å‡½æ•°çš„æ¯æœˆå…è´¹é¢åº¦ä»¥åŠå¤Ÿç”¨äº†ã€‚ï¼ˆç›®å‰åä¸ºäº‘çš„äº‘å‡½æ•°æ˜¯å¯ä»¥å…è´¹é¢åº¦ï¼‰</p>]]></content>
      
      
      <categories>
          
          <category> ä¸€äº›è„šæœ¬ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
            <tag> æ–°é—» </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
